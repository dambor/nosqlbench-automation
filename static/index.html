// Refresh output button click handler
        document.getElementById('refresh-output-btn').addEventListener('click', function() {
            const processId = localStorage.getItem('currentProcessId');
            if (processId) {
                pollProcessStatus(processId);
            } else {
                showAlert('run-alerts', 'danger', 'No active process found.');
            }
        });
        
        // Function to poll process status
        function pollProcessStatus(processId) {
            try {
                callApi(`/api/process/${processId}`)
                    .then(data => {
                        if (data.success) {
                            const outputDiv = document.getElementById('execution-output');
                            const statusSpan = document.getElementById('process-status');
                            
                            if (!outputDiv || !statusSpan) return;
                            
                            // Update output
                            if (data.output) {
                                outputDiv.textContent = data.output;
                            }
                            
                            // Add error output if any
                            if (data.error && data.error.trim() !== '') {
                                outputDiv.textContent += '\n\nErrors:\n' + data.error;
                            }
                            
                            // Update status
                            statusSpan.textContent = `Status: ${data.status.charAt(0).toUpperCase() + data.status.slice(1)}`;
                            
                            // If process completed or failed, show additional info
                            if (data.status === 'completed' || data.status === 'failed') {
                                const duration = data.duration ? `Duration: ${Math.round(data.duration)} seconds` : '';
                                statusSpan.textContent += `, ${duration}`;
                                
                                if (data.status === 'completed') {
                                    showAlert('run-alerts', 'success', 'NoSQLBench process completed successfully!');
                                } else {
                                    showAlert('run-alerts', 'danger', 'NoSQLBench process failed.');
                                }
                            } else {
                                // If process still running, continue polling
                                setTimeout(() => pollProcessStatus(processId), 3000);
                            }
                        } else {
                            showAlert('run-alerts', 'danger', `Error checking process status: ${data.error || 'Unknown error'}`);
                        }
                    })
                    .catch(error => {
                        showAlert('run-alerts', 'danger', `Error polling for status: ${error.message}`);
                    });
            } catch (error) {
                showAlert('run-alerts', 'danger', `Error: ${error.message}`);
            }
        }
        
        // DSBulk form submission
        document.getElementById('dsbulk-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const mode = document.getElementById('dsbulk-mode').value;
            const connectionId = document.getElementById('dsbulk-connection').value;
            const keyspace = document.getElementById('dsbulk-keyspace').value;
            const table = document.getElementById('dsbulk-table').value;
            const csvPath = document.getElementById('dsbulk-csv').value;
            
            if (!connectionId || !keyspace || !table || !csvPath) {
                showAlert('dsbulk-alerts', 'danger', 'Please fill in all required fields.');
                return;
            }
            
            const connectionOption = document.querySelector(`#dsbulk-connection option[value="${connectionId}"]`);
            const isOrigin = connectionOption && connectionOption.dataset.isOrigin === 'true';
            const connection = getDatabaseConnectionById(connectionId, isOrigin);
            
            if (!connection) {
                showAlert('dsbulk-alerts', 'danger', 'Selected connection not found.');
                return;
            }
            
            // Show loading spinner and output section
            toggleLoading('dsbulk-loading', true);
            const outputDiv = document.getElementById('dsbulk-output');
            outputDiv.classList.remove('hidden');
            outputDiv.textContent = 'Running DSBulk operation...\n';
            
            // In a real application, you would make an API call to run DSBulk
            // For this demo, we'll just simulate a successful operation
            
            setTimeout(() => {
                // Hide loading spinner
                toggleLoading('dsbulk-loading', false);
                
                // Generate example output
                const hosts = connection.type === 'astra' ? connection.astraId : connection.hosts;
                
                const output = `DSBulk ${mode} command:
dsbulk ${mode} -k ${keyspace} -t ${table} -url ${csvPath} -h ${hosts}

Output:
Operation directory: /tmp/logs/${mode.toUpperCase()}_${Date.now()}
  - ${mode === 'count' ? 'Total count' : 'Total rows'}: ${Math.floor(Math.random() * 1000000) + 100000}
  - ${mode === 'count' ? '' : 'Total errors: 0\n  - '}${mode === 'count' ? 'Execution' : 'Processing'} time: ${(Math.random() * 30 + 5).toFixed(2)} seconds
${mode === 'count' ? '' : '  - Latency stats:\n    - min/max/mean: 0.33/42.18/1.67 ms\n    - p50/p99/p999: 1.31/7.92/25.14 ms'}
Operation completed successfully.`;
                
                outputDiv.textContent = output;
                
                showAlert('dsbulk-alerts', 'success', `DSBulk ${mode} operation completed successfully!`, true);
            }, 2000);
        });
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize event handlers for database type selectors
            document.getElementById('origin-type')?.dispatchEvent(new Event('change'));
            document.getElementById('dest-type')?.dispatchEvent(new Event('change'));
            
            // Initialize event handlers for environment variable selectors
            document.getElementById('origin-use-env-vars')?.dispatchEvent(new Event('change'));
            document.getElementById('dest-use-env-vars')?.dispatchEvent(new Event('change'));
            
            // Load projects
            loadProjects();
            
            // Load environment variables
            loadEnvironmentVariables();
            
            // Load database connections
            loadDatabaseConnections(true);  // Origin connections
            loadDatabaseConnections(false); // Destination connections
            
            // Update environment variable selectors
            updateEnvVarSelectors();
            
            // Update connection selectors
            updateRunConnectionSelector();
            updateDSBulkConnectionSelector();
            
            // Set active sidebar item to projects list
            document.getElementById('projects-list')?.click();
            
            // Load current project if exists
            const currentProjectId = localStorage.getItem(CURRENT_PROJECT_KEY);
            if (currentProjectId) {
                const project = getProjectById(currentProjectId);
                if (project) {
                    // Update project fields
                    if (document.getElementById('project-name')) {
                        document.getElementById('project-name').value = project.name || '';
                    }
                    if (document.getElementById('keyspace-name')) {
                        document.getElementById('keyspace-name').value = project.keyspace || '';
                    }
                    if (document.getElementById('cql-schema')) {
                        document.getElementById('cql-schema').value = project.schema || '';
                    }
                    if (document.getElementById('schema-form')) {
                        document.getElementById('schema-form').dataset.projectId = project.id;
                    }
                    
                    // Update YAML read selector
                    updateYamlReadSelector(currentProjectId);
                    
                    // Update run project and YAML selectors
                    updateRunProjectSelector();
                }
            }
            
            // Check for active process
            const processId = localStorage.getItem('currentProcessId');
            if (processId) {
                const processControls = document.getElementById('process-controls');
                if (processControls) {
                    processControls.classList.remove('hidden');
                    pollProcessStatus(processId);
                }
            }
        });
    </script>
</body>
</html>            // Get values from the form
            const name = document.getElementById('origin-name').value;
            const dbType = document.getElementById('origin-type').value;
            const useEnvVars = document.getElementById('origin-use-env-vars').value === 'yes';
            
            if (!name) {
                showAlert('origin-db-alerts', 'danger', 'Please provide a connection name.');
                return;
            }
            
            let connectionData = {
                id: connectionId,
                name: name,
                type: dbType,
                useEnvVars: useEnvVars,
                created: new Date().toISOString(),
                connected: false
            };
            
            if (dbType === 'astra') {
                connectionData.astraId = document.getElementById('origin-astra-id').value;
                connectionData.astraRegion = document.getElementById('origin-astra-region').value;
            } else {
                connectionData.hosts = document.getElementById('origin-hosts').value;
                connectionData.port = parseInt(document.getElementById('origin-port').value);
                connectionData.datacenter = document.getElementById('origin-datacenter').value;
            }
            
            if (useEnvVars) {
                connectionData.usernameVar = document.getElementById('origin-username-var').value;
                connectionData.passwordVar = document.getElementById('origin-password-var').value;
            } else {
                connectionData.username = document.getElementById('origin-username').value;
                connectionData.password = document.getElementById('origin-password').value;
            }
            
            // Show loading spinner
            toggleLoading('origin-db-loading', true);
            
            // In a real application, you would make an API call to test the connection
            // For this demo, we'll simulate a successful test
            
            try {
                // Simulate an API call to test the connection
                setTimeout(() => {
                    // Hide loading spinner
                    toggleLoading('origin-db-loading', false);
                    
                    // Mark as connected
                    connectionData.connected = true;
                    connectionData.lastTested = new Date().toISOString();
                    
                    // Save the connection
                    if (saveDatabaseConnection(connectionData, true)) {
                        // Clear the form
                        this.reset();
                        delete this.dataset.connectionId;
                        
                        // Reset form fields
                        document.getElementById('origin-type').dispatchEvent(new Event('change'));
                        document.getElementById('origin-use-env-vars').dispatchEvent(new Event('change'));
                        
                        showAlert('origin-db-alerts', 'success', `Connection "${name}" tested and saved successfully.`, true);
                    } else {
                        showAlert('origin-db-alerts', 'danger', 'Failed to save connection. Please try again.');
                    }
                }, 1500);
            } catch (error) {
                // Hide loading spinner
                toggleLoading('origin-db-loading', false);
                showAlert('origin-db-alerts', 'danger', `Error testing connection: ${error.message}`);
            }
        });
        
        // Save origin connection button handler
        document.getElementById('save-origin-conn-btn').addEventListener('click', function() {
            // Get the connection ID if editing
            const form = document.getElementById('origin-db-form');
            const connectionId = form.dataset.connectionId || generateId();
            
            // Get values from the form
            const name = document.getElementById('origin-name').value;
            const dbType = document.getElementById('origin-type').value;
            const useEnvVars = document.getElementById('origin-use-env-vars').value === 'yes';
            
            if (!name) {
                showAlert('origin-db-alerts', 'danger', 'Please provide a connection name.');
                return;
            }
            
            let connectionData = {
                id: connectionId,
                name: name,
                type: dbType,
                useEnvVars: useEnvVars,
                created: new Date().toISOString(),
                connected: false
            };
            
            if (dbType === 'astra') {
                connectionData.astraId = document.getElementById('origin-astra-id').value;
                connectionData.astraRegion = document.getElementById('origin-astra-region').value;
            } else {
                connectionData.hosts = document.getElementById('origin-hosts').value;
                connectionData.port = parseInt(document.getElementById('origin-port').value);
                connectionData.datacenter = document.getElementById('origin-datacenter').value;
            }
            
            if (useEnvVars) {
                connectionData.usernameVar = document.getElementById('origin-username-var').value;
                connectionData.passwordVar = document.getElementById('origin-password-var').value;
            } else {
                connectionData.username = document.getElementById('origin-username').value;
                connectionData.password = document.getElementById('origin-password').value;
            }
            
            // Save the connection without testing
            if (saveDatabaseConnection(connectionData, true)) {
                // Clear the form
                form.reset();
                delete form.dataset.connectionId;
                
                // Reset form fields
                document.getElementById('origin-type').dispatchEvent(new Event('change'));
                document.getElementById('origin-use-env-vars').dispatchEvent(new Event('change'));
                
                showAlert('origin-db-alerts', 'success', `Connection "${name}" saved successfully.`, true);
            } else {
                showAlert('origin-db-alerts', 'danger', 'Failed to save connection. Please try again.');
            }
        });
        
        // Destination database form submission
        document.getElementById('destination-db-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get the connection ID if editing
            const connectionId = this.dataset.connectionId || generateId();
            
            // Get values from the form
            const name = document.getElementById('dest-name').value;
            const dbType = document.getElementById('dest-type').value;
            const useEnvVars = document.getElementById('dest-use-env-vars').value === 'yes';
            
            if (!name) {
                showAlert('destination-db-alerts', 'danger', 'Please provide a connection name.');
                return;
            }
            
            let connectionData = {
                id: connectionId,
                name: name,
                type: dbType,
                useEnvVars: useEnvVars,
                created: new Date().toISOString(),
                connected: false
            };
            
            if (dbType === 'astra') {
                connectionData.astraId = document.getElementById('dest-astra-id').value;
                connectionData.astraRegion = document.getElementById('dest-astra-region').value;
            } else {
                connectionData.hosts = document.getElementById('dest-hosts').value;
                connectionData.port = parseInt(document.getElementById('dest-port').value);
                connectionData.datacenter = document.getElementById('dest-datacenter').value;
            }
            
            if (useEnvVars) {
                connectionData.usernameVar = document.getElementById('dest-username-var').value;
                connectionData.passwordVar = document.getElementById('dest-password-var').value;
            } else {
                connectionData.username = document.getElementById('dest-username').value;
                connectionData.password = document.getElementById('dest-password').value;
            }
            
            // Show loading spinner
            toggleLoading('dest-db-loading', true);
            
            // In a real application, you would make an API call to test the connection
            // For this demo, we'll simulate a successful test
            
            try {
                // Simulate an API call to test the connection
                setTimeout(() => {
                    // Hide loading spinner
                    toggleLoading('dest-db-loading', false);
                    
                    // Mark as connected
                    connectionData.connected = true;
                    connectionData.lastTested = new Date().toISOString();
                    
                    // Save the connection
                    if (saveDatabaseConnection(connectionData, false)) {
                        // Clear the form
                        this.reset();
                        delete this.dataset.connectionId;
                        
                        // Reset form fields
                        document.getElementById('dest-type').dispatchEvent(new Event('change'));
                        document.getElementById('dest-use-env-vars').dispatchEvent(new Event('change'));
                        
                        showAlert('destination-db-alerts', 'success', `Connection "${name}" tested and saved successfully.`, true);
                    } else {
                        showAlert('destination-db-alerts', 'danger', 'Failed to save connection. Please try again.');
                    }
                }, 1500);
            } catch (error) {
                // Hide loading spinner
                toggleLoading('dest-db-loading', false);
                showAlert('destination-db-alerts', 'danger', `Error testing connection: ${error.message}`);
            }
        });
        
        // Save destination connection button handler
        document.getElementById('save-dest-conn-btn').addEventListener('click', function() {
            // Get the connection ID if editing
            const form = document.getElementById('destination-db-form');
            const connectionId = form.dataset.connectionId || generateId();
            
            // Get values from the form
            const name = document.getElementById('dest-name').value;
            const dbType = document.getElementById('dest-type').value;
            const useEnvVars = document.getElementById('dest-use-env-vars').value === 'yes';
            
            if (!name) {
                showAlert('destination-db-alerts', 'danger', 'Please provide a connection name.');
                return;
            }
            
            let connectionData = {
                id: connectionId,
                name: name,
                type: dbType,
                useEnvVars: useEnvVars,
                created: new Date().toISOString(),
                connected: false
            };
            
            if (dbType === 'astra') {
                connectionData.astraId = document.getElementById('dest-astra-id').value;
                connectionData.astraRegion = document.getElementById('dest-astra-region').value;
            } else {
                connectionData.hosts = document.getElementById('dest-hosts').value;
                connectionData.port = parseInt(document.getElementById('dest-port').value);
                connectionData.datacenter = document.getElementById('dest-datacenter').value;
            }
            
            if (useEnvVars) {
                connectionData.usernameVar = document.getElementById('dest-username-var').value;
                connectionData.passwordVar = document.getElementById('dest-password-var').value;
            } else {
                connectionData.username = document.getElementById('dest-username').value;
                connectionData.password = document.getElementById('dest-password').value;
            }
            
            // Save the connection without testing
            if (saveDatabaseConnection(connectionData, false)) {
                // Clear the form
                form.reset();
                delete form.dataset.connectionId;
                
                // Reset form fields
                document.getElementById('dest-type').dispatchEvent(new Event('change'));
                document.getElementById('dest-use-env-vars').dispatchEvent(new Event('change'));
                
                showAlert('destination-db-alerts', 'success', `Connection "${name}" saved successfully.`, true);
            } else {
                showAlert('destination-db-alerts', 'danger', 'Failed to save connection. Please try again.');
            }
        });
        
        // Handle file upload
        document.getElementById('schema-file').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            // Show selected filename
            document.getElementById('file-name').textContent = file.name;
            
            // Read file contents
            const reader = new FileReader();
            reader.onload = function(event) {
                document.getElementById('cql-schema').value = event.target.result;
                showAlert('schema-alerts', 'success', `File "${file.name}" loaded successfully!`, true);
            };
            reader.onerror = function() {
                showAlert('schema-alerts', 'danger', 'Error reading the file.');
            };
            reader.readAsText(file);
        });
        
        // Load example CQL schema
        document.getElementById('load-example-btn').addEventListener('click', function() {
            const exampleSchema = `CREATE TABLE centralpayment.pay_with_app_purchase_request_by_id (
    sessionid text,
    insertedtimestamp timestamp,
    amount decimal,
    fraudcheckisrequested boolean,
    fsaamount decimal,
    fsarxamount decimal,
    giftcardeligibleamount decimal,
    lanenumber text,
    ordertotal decimal,
    salestaxamount decimal,
    storenumber text,
    transactiondate timestamp,
    PRIMARY KEY (sessionid, insertedtimestamp)
) WITH CLUSTERING ORDER BY (insertedtimestamp DESC);

CREATE TABLE centralpayment.transaction_by_id (
    transactionid text,
    amount decimal,
    cardtype text,
    processeddate timestamp,
    status text,
    storenumber text,
    PRIMARY KEY (transactionid)
);`;
            
            document.getElementById('project-name').value = 'Payment System';
            document.getElementById('keyspace-name').value = 'centralpayment';
            document.getElementById('cql-schema').value = exampleSchema;
            
            showAlert('schema-alerts', 'success', 'Example CQL schema loaded!', true);
        });
        
        // Parse schema form submission
        document.getElementById('schema-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const projectName = document.getElementById('project-name').value;
            const keyspaceName = document.getElementById('keyspace-name').value;
            const cqlSchema = document.getElementById('cql-schema').value;
            
            if (!projectName || !keyspaceName || !cqlSchema) {
                showAlert('schema-alerts', 'danger', 'Please provide project name, keyspace name, and CQL schema.');
                return;
            }
            
            // Show loading spinner
            toggleLoading('schema-loading', true);
            
            try {
                // Call API to parse the schema
                callApi('/api/parse-cql', 'POST', {
                    schema: cqlSchema
                })
                .then(data => {
                    // Hide loading spinner
                    toggleLoading('schema-loading', false);
                    
                    if (data.success) {
                        // Create project object
                        const projectId = document.getElementById('schema-form').dataset.projectId || generateId();
                        const project = {
                            id: projectId,
                            name: projectName,
                            keyspace: keyspaceName,
                            schema: cqlSchema,
                            tables: data.tables,
                            created: new Date().toISOString(),
                            yamlFiles: []
                        };
                        
                        // If editing an existing project, preserve its YAML files
                        if (document.getElementById('schema-form').dataset.projectId) {
                            const existingProject = getProjectById(projectId);
                            if (existingProject && existingProject.yamlFiles) {
                                project.yamlFiles = existingProject.yamlFiles;
                            }
                        }
                        
                        // Save the project
                        if (saveProject(project)) {
                            // Update schema form with the project ID
                            document.getElementById('schema-form').dataset.projectId = project.id;
                            
                            showAlert('schema-alerts', 'success', `Schema parsed successfully! Found ${data.tables.length} table(s).`);
                            
                            // Navigate to YAML generation
                            document.getElementById('yaml-config').click();
                        } else {
                            showAlert('schema-alerts', 'danger', 'Error saving project.');
                        }
                    } else {
                        showAlert('schema-alerts', 'danger', `Error parsing schema: ${data.error || 'Unknown error'}`);
                    }
                })
                .catch(error => {
                    // Hide loading spinner
                    toggleLoading('schema-loading', false);
                    showAlert('schema-alerts', 'danger', `Error communicating with the server: ${error.message}`);
                });
            } catch (error) {
                // Hide loading spinner
                toggleLoading('schema-loading', false);
                showAlert('schema-alerts', 'danger', `Error: ${error.message}`);
            }
        });
        
        // Generate YAML form submission
        document.getElementById('yaml-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const numCycles = document.getElementById('num-cycles').value;
            const threads = document.getElementById('threads').value;
            
            if (!numCycles) {
                showAlert('yaml-alerts', 'danger', 'Please specify the number of cycles.');
                return;
            }
            
            // Get current project
            const currentProjectId = localStorage.getItem(CURRENT_PROJECT_KEY);
            if (!currentProjectId) {
                showAlert('yaml-alerts', 'danger', 'No project selected. Please select or create a project first.');
                return;
            }
            
            const project = getProjectById(currentProjectId);
            if (!project) {
                showAlert('yaml-alerts', 'danger', 'Selected project not found. Please select or create a project first.');
                return;
            }
            
            // Show loading spinner
            toggleLoading('yaml-loading', true);
            
            try {
                // Call API to generate YAML
                callApi('/api/generate-yaml', 'POST', {
                    keyspace: project.keyspace,
                    schema: project.schema,
                    cycles: parseInt(numCycles),
                    threads: threads
                })
                .then(data => {
                    // Hide loading spinner
                    toggleLoading('yaml-loading', false);
                    
                    if (data.success) {
                        // Store YAML files in project
                        project.yamlFiles = data.yaml_files;
                        
                        // Save the updated project
                        if (saveProject(project)) {
                            // Show the YAML output section
                            document.getElementById('yaml-output').classList.remove('hidden');
                            
                            // Show the first YAML file content
                            if (data.yaml_files.length > 0) {
                                document.getElementById('yaml-content').textContent = data.yaml_files[0].content;
                            }
                            
                            // Add tabs for each YAML file
                            const tabs = document.getElementById('yaml-tabs');
                            tabs.innerHTML = '';
                            
                            data.yaml_files.forEach((file, index) => {
                                const tab = document.createElement('div');
                                tab.className = `sidebar-item${index === 0 ? ' active' : ''}`;
                                tab.textContent = file.name;
                                tab.setAttribute('data-index', index);
                                tab.onclick = function() {
                                    // Update active tab
                                    document.querySelectorAll('#yaml-tabs .sidebar-item').forEach(t => t.classList.remove('active'));
                                    this.classList.add('active');
                                    
                                    // Show the selected YAML content
                                    const idx = this.getAttribute('data-index');
                                    if (idx >= 0 && idx < data.yaml_files.length) {
                                        document.getElementById('yaml-content').textContent = data.yaml_files[idx].content;
                                    }
                                };
                                tabs.appendChild(tab);
                            });
                            
                            // Update YAML selectors in the run tab
                            updateRunYamlFileSelector(currentProjectId);
                            
                            // Update YAML selectors in the YAML read tab
                            updateYamlReadSelector(currentProjectId);
                            
                            showAlert('yaml-alerts', 'success', `Generated ${data.yaml_files.length} YAML file(s) successfully!`);
                        } else {
                            showAlert('yaml-alerts', 'danger', 'Error saving YAML files to project.');
                        }
                    } else {
                        showAlert('yaml-alerts', 'danger', `Error generating YAML: ${data.error || 'Unknown error'}`);
                    }
                })
                .catch(error => {
                    // Hide loading spinner
                    toggleLoading('yaml-loading', false);
                    
                    showAlert('yaml-alerts', 'danger', `Error communicating with the server: ${error.message}`);
                });
            } catch (error) {
                // Hide loading spinner
                toggleLoading('yaml-loading', false);
                showAlert('yaml-alerts', 'danger', `Error: ${error.message}`);
            }
        });
        
        // YAML Read button click handler
        document.getElementById('yaml-read-btn').addEventListener('click', function() {
            const yamlId = document.getElementById('yaml-read-file').value;
            if (!yamlId) {
                showAlert('yaml-read-alerts', 'danger', 'Please select a YAML file.');
                return;
            }
            
            // Get current project
            const currentProjectId = localStorage.getItem(CURRENT_PROJECT_KEY);
            if (!currentProjectId) {
                showAlert('yaml-read-alerts', 'danger', 'No project selected. Please select a project first.');
                return;
            }
            
            const project = getProjectById(currentProjectId);
            if (!project || !project.yamlFiles) {
                showAlert('yaml-read-alerts', 'danger', 'Project YAML files not found.');
                return;
            }
            
            const yamlFile = project.yamlFiles.find(file => file.id === yamlId);
            if (!yamlFile) {
                showAlert('yaml-read-alerts', 'danger', 'Selected YAML file not found.');
                return;
            }
            
            // Show the YAML content
            const outputElement = document.getElementById('yaml-read-output');
            outputElement.textContent = yamlFile.content;
            outputElement.classList.remove('hidden');
            
            showAlert('yaml-read-alerts', 'success', `Loaded YAML file: ${yamlFile.name}`, true);
        });
        
        // Copy YAML button click handler
        document.getElementById('copy-yaml-btn').addEventListener('click', function() {
            const yamlContent = document.getElementById('yaml-content');
            if (!yamlContent) return;
            
            const text = yamlContent.textContent;
            if (!text) {
                showAlert('yaml-alerts', 'danger', 'No YAML content to copy.');
                return;
            }
            
            // Use the clipboard API to copy text
            navigator.clipboard.writeText(text)
                .then(() => {
                    showAlert('yaml-alerts', 'success', 'YAML copied to clipboard!', true);
                })
                .catch(err => {
                    console.error('Failed to copy text: ', err);
                    showAlert('yaml-alerts', 'danger', 'Failed to copy text. Please try manually selecting and copying.');
                });
        });
        
        // Download all YAML files button
        document.getElementById('download-all-btn').addEventListener('click', function() {
            // Get current project
            const currentProjectId = localStorage.getItem(CURRENT_PROJECT_KEY);
            if (!currentProjectId) {
                showAlert('yaml-alerts', 'danger', 'No project selected. Please select a project first.');
                return;
            }
            
            const project = getProjectById(currentProjectId);
            if (!project || !project.yamlFiles || project.yamlFiles.length === 0) {
                showAlert('yaml-alerts', 'danger', 'No YAML files found in the current project.');
                return;
            }
            
            try {
                // Redirect to download endpoint
                window.location.href = `${API_BASE_URL}/api/download-all`;
                showAlert('yaml-alerts', 'success', 'Downloading all YAML files...', true);
            } catch (error) {
                showAlert('yaml-alerts', 'danger', `Error downloading files: ${error.message}`);
            }
        });
        
        // Run project change handler
        document.getElementById('run-project').addEventListener('change', function() {
            const projectId = this.value;
            updateRunYamlFileSelector(projectId);
        });
        
        // Run connection change handler
        document.getElementById('run-connection').addEventListener('change', function() {
            updateRunCommandPreview();
        });
        
        // Run YAML file change handler
        document.getElementById('run-yaml-file').addEventListener('change', function() {
            updateRunCommandPreview();
        });
        
        // Run command options input handler
        document.getElementById('run-command-options').addEventListener('input', function() {
            updateRunCommandPreview();
        });
        
        // Run benchmark form submission
        document.getElementById('run-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const projectId = document.getElementById('run-project').value;
            const yamlId = document.getElementById('run-yaml-file').value;
            const connectionId = document.getElementById('run-connection').value;
            const commandOptions = document.getElementById('run-command-options').value;
            
            if (!projectId || !yamlId || !connectionId) {
                showAlert('run-alerts', 'danger', 'Please select a project, YAML file, and database connection.');
                return;
            }
            
            const project = getProjectById(projectId);
            if (!project) {
                showAlert('run-alerts', 'danger', 'Selected project not found.');
                return;
            }
            
            const connectionOption = document.querySelector(`#run-connection option[value="${connectionId}"]`);
            const isOrigin = connectionOption && connectionOption.dataset.isOrigin === 'true';
            const connection = getDatabaseConnectionById(connectionId, isOrigin);
            
            if (!connection) {
                showAlert('run-alerts', 'danger', 'Selected connection not found.');
                return;
            }
            
            // Show output section and loading spinner
            document.getElementById('run-output').classList.remove('hidden');
            toggleLoading('run-loading', true);
            
            // Hide process controls
            document.getElementById('process-controls').classList.add('hidden');
            
            const outputDiv = document.getElementById('execution-output');
            outputDiv.textContent = 'Running NoSQLBench...\n';
            
            try {
                // Call API to run NoSQLBench
                callApi('/api/run-nosqlbench', 'POST', {
                    yaml_id: yamlId,
                    connection_id: connectionId,
                    keyspace: project.keyspace,
                    options: commandOptions
                })
                .then(data => {
                    // Hide loading spinner
                    toggleLoading('run-loading', false);
                    
                    if (data.success) {
                        outputDiv.textContent = `Started NoSQLBench process\nCommand: ${data.command}\n\nProcess ID: ${data.process_id}\n\nInitial output will appear shortly...`;
                        
                        // Store process ID in local storage
                        localStorage.setItem('currentProcessId', data.process_id);
                        
                        // Show process controls
                        document.getElementById('process-controls').classList.remove('hidden');
                        document.getElementById('process-status').textContent = 'Status: Running';
                        
                        // Start polling for process status
                        pollProcessStatus(data.process_id);
                        
                        showAlert('run-alerts', 'success', 'NoSQLBench process started!', true);
                    } else {
                        outputDiv.textContent = `Error starting NoSQLBench process: ${data.error || 'Unknown error'}\n`;
                        showAlert('run-alerts', 'danger', 'Error starting NoSQLBench process.');
                    }
                })
                .catch(error => {
                    // Hide loading spinner
                    toggleLoading('run-loading', false);
                    
                    outputDiv.textContent = `Error communicating with the server: ${error.message}\n`;
                    showAlert('run-alerts', 'danger', `Error communicating with the server: ${error.message}`);
                });
            } catch (error) {
                // Hide loading spinner
                toggleLoading('run-loading', false);
                
                outputDiv.textContent = `Error: ${error.message}\n`;
                showAlert('run-alerts', 'danger', `Error: ${error.message}`);
            }
        });
        
        // Run direct button click handler
        document.getElementById('run-direct-btn').addEventListener('click', function() {
            const projectId = document.getElementById('run-project').value;
            const yamlId = document.getElementById('run-yaml-file').value;
            
            if (!projectId || !yamlId) {
                showAlert('run-alerts', 'danger', 'Please select a project and YAML file.');
                return;
            }
            
            const project = getProjectById(projectId);
            if (!project) {
                showAlert('run-alerts', 'danger', 'Selected project not found.');
                return;
            }
            
            // Show output section and loading spinner
            document.getElementById('run-output').classList.remove('hidden');
            toggleLoading('run-loading', true);
            
            // Hide process controls
            document.getElementById('process-controls').classList.add('hidden');
            
            const outputDiv = document.getElementById('execution-output');
            outputDiv.textContent = 'Running NoSQLBench (direct execution)...\n';
            
            try {
                // Call API to run NoSQLBench directly
                callApi('/api/run-nosqlbench-direct', 'POST', {
                    yaml_id: yamlId,
                    keyspace: project.keyspace
                })
                .then(data => {
                    // Hide loading spinner
                    toggleLoading('run-loading', false);
                    
                    if (data.success) {
                        outputDiv.textContent = `Executed command:\n${data.command}\n\n`;
                        
                        if (data.timeout) {
                            outputDiv.textContent += data.output + '\n\n';
                            outputDiv.textContent += 'The command is still running in background. Check your database in a few minutes to see the results.\n';
                        } else if (data.output) {
                            outputDiv.textContent += data.output;
                        } else {
                            outputDiv.textContent += 'Command executed successfully, but no output was returned.\n';
                        }
                        
                        showAlert('run-alerts', 'success', 'NoSQLBench command executed!', true);
                    } else {
                        outputDiv.textContent = `Error executing command:\n${data.command || 'Unknown command'}\n\n`;
                        if (data.error) {
                            outputDiv.textContent += `Error: ${data.error}\n`;
                        }
                        if (data.output) {
                            outputDiv.textContent += `Output: ${data.output}\n`;
                        }
                        
                        showAlert('run-alerts', 'danger', 'Error executing NoSQLBench command.');
                    }
                })
                .catch(error => {
                    // Hide loading spinner
                    toggleLoading('run-loading', false);
                    
                    outputDiv.textContent = `Error communicating with the server: ${error.message}\n`;
                    showAlert('run-alerts', 'danger', `Error communicating with the server: ${error.message}`);
                });
            } catch (error) {
                // Hide loading spinner
                toggleLoading('run-loading', false);
                
                outputDiv.textContent = `Error: ${error.message}\n`;
                showAlert('run-alerts', 'danger', `Error: ${error.message}`);
            }
        });
        
        // Refresh output button click handler
        document.getElementById('refresh-output-btn').addEventListener('click', function() {
            const processId = localStorage.getItem('currentProcessId');
            if (processId) {
                pollProcessStatus(processId);
            } else {
                showAlert('run-alerts', 'danger', 'No active process found.');
            }
        });
        
        //                varElement.appendChild(nameInput);
                varElement.appendChild(valueInput);
                varElement.appendChild(actionsDiv);
                
                envVarsContainer.appendChild(varElement);
            });
        }
        
        // Function to get an environment variable by ID
        function getEnvironmentVariableById(envVarId) {
            if (!envVarId) return null;
            
            const envVars = getLocalStorageItem(ENV_VARS_STORAGE_KEY);
            return envVars.find(v => v.id === envVarId) || null;
        }
        
        // Function to edit an environment variable
        function editEnvironmentVariable(envVarId) {
            const envVar = getEnvironmentVariableById(envVarId);
            if (!envVar) {
                showAlert('env-config-alerts', 'danger', 'Environment variable not found.');
                return;
            }
            
            // Fill the modal form
            document.getElementById('modal-env-var-name').value = envVar.name || '';
            document.getElementById('modal-env-var-value').value = envVar.value || '';
            document.getElementById('modal-env-var-description').value = envVar.description || '';
            document.getElementById('modal-env-var-is-secret').value = envVar.isSecret ? 'yes' : 'no';
            document.getElementById('modal-env-var-id').value = envVar.id;
            
            // Update modal title
            document.getElementById('env-var-modal-title').textContent = 'Edit Environment Variable';
            
            // Show the modal
            document.getElementById('env-var-modal').classList.remove('hidden');
        }
        
        // Function to confirm environment variable deletion
        function confirmDeleteEnvironmentVariable(envVarId, envVarName) {
            if (confirm(`Are you sure you want to delete the environment variable "${envVarName}"?`)) {
                deleteEnvironmentVariable(envVarId);
                showAlert('env-config-alerts', 'success', `Environment variable "${envVarName}" deleted successfully.`, true);
            }
        }
        
        // Function to update environment variable selectors in database forms
        function updateEnvVarSelectors() {
            const envVars = getLocalStorageItem(ENV_VARS_STORAGE_KEY);
            const selectors = [
                document.getElementById('origin-username-var'),
                document.getElementById('origin-password-var'),
                document.getElementById('dest-username-var'),
                document.getElementById('dest-password-var')
            ];
            
            // Update each selector
            selectors.forEach(selector => {
                if (!selector) return;
                
                // Clear the selector but keep the first option
                const firstOption = selector.options[0];
                selector.innerHTML = '';
                if (firstOption) {
                    selector.appendChild(firstOption);
                } else {
                    // Create a default first option if it doesn't exist
                    const defaultOption = document.createElement('option');
                    defaultOption.value = '';
                    defaultOption.textContent = 'Select a variable';
                    selector.appendChild(defaultOption);
                }
                
                // Add each environment variable to the selector
                envVars.forEach(envVar => {
                    const option = document.createElement('option');
                    option.value = envVar.id;
                    option.textContent = envVar.name;
                    selector.appendChild(option);
                });
            });
        }
        
        // Function to save a database connection
        function saveDatabaseConnection(connection, isOrigin = true) {
            const storageKey = isOrigin ? ORIGIN_CONNS_STORAGE_KEY : DEST_CONNS_STORAGE_KEY;
            const connections = getLocalStorageItem(storageKey);
            
            // Check if connection already exists
            const existingIndex = connections.findIndex(c => c.id === connection.id);
            if (existingIndex >= 0) {
                // Update existing connection
                connections[existingIndex] = connection;
            } else {
                // Add new connection
                connections.push(connection);
            }
            
            // Save to local storage
            setLocalStorageItem(storageKey, connections);
            
            // Refresh connection list
            loadDatabaseConnections(isOrigin);
            
            // Update connection selector in the run benchmark card
            updateRunConnectionSelector();
            
            // Update connection selector in the DSBulk card
            updateDSBulkConnectionSelector();
            
            return true;
        }
        
        // Function to delete a database connection
        function deleteDatabaseConnection(connectionId, isOrigin = true) {
            if (!connectionId) return false;
            
            const storageKey = isOrigin ? ORIGIN_CONNS_STORAGE_KEY : DEST_CONNS_STORAGE_KEY;
            const connections = getLocalStorageItem(storageKey);
            
            // Filter out the deleted connection
            const updatedConnections = connections.filter(c => c.id !== connectionId);
            
            // Save the updated connections
            setLocalStorageItem(storageKey, updatedConnections);
            
            // Refresh connection list
            loadDatabaseConnections(isOrigin);
            
            // Update connection selectors
            updateRunConnectionSelector();
            updateDSBulkConnectionSelector();
            
            return true;
        }
        
        // Function to load database connections and update UI
        function loadDatabaseConnections(isOrigin = true) {
            const storageKey = isOrigin ? ORIGIN_CONNS_STORAGE_KEY : DEST_CONNS_STORAGE_KEY;
            const tableId = isOrigin ? 'origin-connections-table' : 'dest-connections-table';
            
            const connections = getLocalStorageItem(storageKey);
            const tableBody = document.querySelector(`#${tableId} tbody`);
            
            if (!tableBody) return;
            
            // Clear the table
            tableBody.innerHTML = '';
            
            if (connections.length === 0) {
                const row = document.createElement('tr');
                const cell = document.createElement('td');
                cell.colSpan = 5;
                cell.textContent = 'No connections saved yet.';
                cell.style.textAlign = 'center';
                row.appendChild(cell);
                tableBody.appendChild(row);
                return;
            }
            
            // Add each connection to the table
            connections.forEach(connection => {
                const row = document.createElement('tr');
                
                // Name column
                const nameCell = document.createElement('td');
                nameCell.textContent = connection.name || '';
                row.appendChild(nameCell);
                
                // Type column
                const typeCell = document.createElement('td');
                typeCell.textContent = connection.type === 'cassandra' ? 'Apache Cassandra' : 
                                    connection.type === 'dse' ? 'DataStax Enterprise' : 'Astra DB';
                row.appendChild(typeCell);
                
                // Host column
                const hostCell = document.createElement('td');
                if (connection.type === 'astra') {
                    hostCell.textContent = connection.astraId || 'N/A';
                } else {
                    hostCell.textContent = connection.hosts || '127.0.0.1';
                }
                row.appendChild(hostCell);
                
                // Status column
                const statusCell = document.createElement('td');
                const statusIndicator = document.createElement('span');
                statusIndicator.className = `connection-status ${connection.connected ? 'connected' : 'disconnected'}`;
                statusCell.appendChild(statusIndicator);
                statusCell.appendChild(document.createTextNode(connection.connected ? ' Connected' : ' Not Connected'));
                row.appendChild(statusCell);
                
                // Actions column
                const actionsCell = document.createElement('td');
                
                const testButton = document.createElement('button');
                testButton.className = 'action-btn';
                testButton.innerHTML = '🔄';
                testButton.title = 'Test Connection';
                testButton.addEventListener('click', () => testConnection(connection.id, isOrigin));
                
                const editButton = document.createElement('button');
                editButton.className = 'action-btn edit';
                editButton.innerHTML = '✏️';
                editButton.title = 'Edit Connection';
                editButton.addEventListener('click', () => editConnection(connection.id, isOrigin));
                
                const deleteButton = document.createElement('button');
                deleteButton.className = 'action-btn delete';
                deleteButton.innerHTML = '🗑️';
                deleteButton.title = 'Delete Connection';
                deleteButton.addEventListener('click', () => confirmDeleteConnection(connection.id, connection.name, isOrigin));
                
                actionsCell.appendChild(testButton);
                actionsCell.appendChild(editButton);
                actionsCell.appendChild(deleteButton);
                
                row.appendChild(actionsCell);
                
                tableBody.appendChild(row);
            });
        }
        
        // Function to get a database connection by ID
        function getDatabaseConnectionById(connectionId, isOrigin = true) {
            if (!connectionId) return null;
            
            const storageKey = isOrigin ? ORIGIN_CONNS_STORAGE_KEY : DEST_CONNS_STORAGE_KEY;
            const connections = getLocalStorageItem(storageKey);
            return connections.find(c => c.id === connectionId) || null;
        }
        
        // Function to test a database connection
        function testConnection(connectionId, isOrigin = true) {
            const connection = getDatabaseConnectionById(connectionId, isOrigin);
            const alertsId = isOrigin ? 'origin-db-alerts' : 'destination-db-alerts';
            const loadingId = isOrigin ? 'origin-db-loading' : 'dest-db-loading';
            
            if (!connection) {
                showAlert(alertsId, 'danger', 'Connection not found.');
                return;
            }
            
            // In a real implementation, make an API call to test the connection
            // For this demo, we'll simulate a successful test
            
            // Show loading spinner
            toggleLoading(loadingId, true);
            
            // Simulate API call
            setTimeout(() => {
                // Hide loading spinner
                toggleLoading(loadingId, false);
                
                // Update connection status
                connection.connected = true;
                connection.lastTested = new Date().toISOString();
                
                // Save the updated connection
                saveDatabaseConnection(connection, isOrigin);
                
                showAlert(alertsId, 'success', `Connection "${connection.name}" tested successfully.`, true);
            }, 1500);
        }
        
        // Function to edit a database connection
        function editConnection(connectionId, isOrigin = true) {
            const connection = getDatabaseConnectionById(connectionId, isOrigin);
            const formPrefix = isOrigin ? 'origin' : 'dest';
            const alertsId = isOrigin ? 'origin-db-alerts' : 'destination-db-alerts';
            const formId = isOrigin ? 'origin-db-form' : 'destination-db-form';
            
            if (!connection) {
                showAlert(alertsId, 'danger', 'Connection not found.');
                return;
            }
            
            // Fill the form
            document.getElementById(`${formPrefix}-name`).value = connection.name || '';
            document.getElementById(`${formPrefix}-type`).value = connection.type || 'cassandra';
            
            // Trigger type change event to show/hide fields
            document.getElementById(`${formPrefix}-type`).dispatchEvent(new Event('change'));
            
            if (connection.type === 'astra') {
                document.getElementById(`${formPrefix}-astra-id`).value = connection.astraId || '';
                document.getElementById(`${formPrefix}-astra-region`).value = connection.astraRegion || '';
            } else {
                document.getElementById(`${formPrefix}-hosts`).value = connection.hosts || '127.0.0.1';
                document.getElementById(`${formPrefix}-port`).value = connection.port || 9042;
                document.getElementById(`${formPrefix}-datacenter`).value = connection.datacenter || 'datacenter1';
            }
            
            document.getElementById(`${formPrefix}-username`).value = connection.username || '';
            document.getElementById(`${formPrefix}-password`).value = connection.password || '';
            
            document.getElementById(`${formPrefix}-use-env-vars`).value = connection.useEnvVars ? 'yes' : 'no';
            
            // Trigger env vars change event
            document.getElementById(`${formPrefix}-use-env-vars`).dispatchEvent(new Event('change'));
            
            if (connection.useEnvVars) {
                document.getElementById(`${formPrefix}-username-var`).value = connection.usernameVar || '';
                document.getElementById(`${formPrefix}-password-var`).value = connection.passwordVar || '';
            }
            
            // Store the connection ID in a data attribute for later retrieval
            document.getElementById(formId).dataset.connectionId = connectionId;
            
            // Show "editing" message
            showAlert(alertsId, 'info', `Editing connection "${connection.name}". Click "Save Connection" when done.`);
        }
        
        // Function to confirm connection deletion
        function confirmDeleteConnection(connectionId, connectionName, isOrigin = true) {
            const alertsId = isOrigin ? 'origin-db-alerts' : 'destination-db-alerts';
            
            if (confirm(`Are you sure you want to delete the connection "${connectionName}"?`)) {
                if (deleteDatabaseConnection(connectionId, isOrigin)) {
                    showAlert(alertsId, 'success', `Connection "${connectionName}" deleted successfully.`, true);
                } else {
                    showAlert(alertsId, 'danger', `Failed to delete connection "${connectionName}".`);
                }
            }
        }
        
        // Function to update the run connection selector
        function updateRunConnectionSelector() {
            const originConnections = getLocalStorageItem(ORIGIN_CONNS_STORAGE_KEY);
            const destConnections = getLocalStorageItem(DEST_CONNS_STORAGE_KEY);
            const selector = document.getElementById('run-connection');
            
            if (!selector) return;
            
            // Clear the selector
            selector.innerHTML = '<option value="">Select a connection</option>';
            
            // Add origin connections
            if (originConnections.length > 0) {
                const originGroup = document.createElement('optgroup');
                originGroup.label = 'Origin Connections';
                
                originConnections.forEach(connection => {
                    const option = document.createElement('option');
                    option.value = connection.id;
                    option.dataset.isOrigin = 'true';
                    option.textContent = connection.name;
                    originGroup.appendChild(option);
                });
                
                selector.appendChild(originGroup);
            }
            
            // Add destination connections
            if (destConnections.length > 0) {
                const destGroup = document.createElement('optgroup');
                destGroup.label = 'Destination Connections';
                
                destConnections.forEach(connection => {
                    const option = document.createElement('option');
                    option.value = connection.id;
                    option.dataset.isOrigin = 'false';
                    option.textContent = connection.name;
                    destGroup.appendChild(option);
                });
                
                selector.appendChild(destGroup);
            }
            
            // Update command preview
            updateRunCommandPreview();
        }
        
        // Function to update DSBulk connection selector
        function updateDSBulkConnectionSelector() {
            const originConnections = getLocalStorageItem(ORIGIN_CONNS_STORAGE_KEY);
            const destConnections = getLocalStorageItem(DEST_CONNS_STORAGE_KEY);
            const selector = document.getElementById('dsbulk-connection');
            
            if (!selector) return;
            
            // Clear the selector
            selector.innerHTML = '<option value="">Select a connection</option>';
            
            // Add origin connections
            if (originConnections.length > 0) {
                const originGroup = document.createElement('optgroup');
                originGroup.label = 'Origin Connections';
                
                originConnections.forEach(connection => {
                    const option = document.createElement('option');
                    option.value = connection.id;
                    option.dataset.isOrigin = 'true';
                    option.textContent = connection.name;
                    originGroup.appendChild(option);
                });
                
                selector.appendChild(originGroup);
            }
            
            // Add destination connections
            if (destConnections.length > 0) {
                const destGroup = document.createElement('optgroup');
                destGroup.label = 'Destination Connections';
                
                destConnections.forEach(connection => {
                    const option = document.createElement('option');
                    option.value = connection.id;
                    option.dataset.isOrigin = 'false';
                    option.textContent = connection.name;
                    destGroup.appendChild(option);
                });
                
                selector.appendChild(destGroup);
            }
        }
        
        // Function to update the YAML read selector
        function updateYamlReadSelector(projectId) {
            const project = getProjectById(projectId);
            const selector = document.getElementById('yaml-read-file');
            
            if (!selector) return;
            
            // Clear the selector
            selector.innerHTML = '<option value="">Select YAML file</option>';
            
            if (project && project.yamlFiles && project.yamlFiles.length > 0) {
                // Add each YAML file to the selector
                project.yamlFiles.forEach(file => {
                    const option = document.createElement('option');
                    option.value = file.id;
                    option.textContent = file.name;
                    selector.appendChild(option);
                });
            }
        }
        
        // Function to make an API call with error handling
        async function callApi(endpoint, method = 'GET', data = null) {
            try {
                const options = {
                    method,
                    headers: {
                        'Content-Type': 'application/json'
                    }
                };
                
                if (data) {
                    options.body = JSON.stringify(data);
                }
                
                const response = await fetch(`${API_BASE_URL}${endpoint}`, options);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`API error (${response.status}): ${errorText}`);
                }
                
                return await response.json();
            } catch (error) {
                console.error(`API call to ${endpoint} failed:`, error);
                throw error;
            }
        }
        
        // Sidebar navigation
        document.querySelectorAll('.sidebar-item').forEach(item => {
            item.addEventListener('click', function() {
                // Deactivate all sidebar items
                document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
                
                // Activate clicked item
                this.classList.add('active');
                
                // Hide all cards
                document.querySelectorAll('.card').forEach(card => card.classList.add('hidden'));
                
                // Show the appropriate card based on sidebar item clicked
                const itemId = this.id;
                if (itemId === 'projects-list') {
                    document.getElementById('projects-list-card').classList.remove('hidden');
                } else if (itemId === 'project-config') {
                    document.getElementById('schema-card').classList.remove('hidden');
                } else if (itemId === 'yaml-config') {
                    document.getElementById('yaml-card').classList.remove('hidden');
                } else if (itemId === 'env-config') {
                    document.getElementById('env-config-card').classList.remove('hidden');
                } else if (itemId === 'origin-db') {
                    document.getElementById('origin-db-card').classList.remove('hidden');
                } else if (itemId === 'destination-db') {
                    document.getElementById('destination-db-card').classList.remove('hidden');
                } else if (itemId === 'yaml-read') {
                    document.getElementById('yaml-read-card').classList.remove('hidden');
                } else if (itemId === 'dsbulk') {
                    document.getElementById('dsbulk-card').classList.remove('hidden');
                } else if (itemId === 'run-bench') {
                    document.getElementById('run-bench-card').classList.remove('hidden');
                }
            });
        });
        
        // Project selector change handler
        document.getElementById('current-project-selector').addEventListener('change', function() {
            const projectId = this.value;
            if (projectId) {
                localStorage.setItem(CURRENT_PROJECT_KEY, projectId);
                
                // Load project details into the schema form
                const project = getProjectById(projectId);
                if (project) {
                    document.getElementById('project-name').value = project.name || '';
                    document.getElementById('keyspace-name').value = project.keyspace || '';
                    document.getElementById('cql-schema').value = project.schema || '';
                    document.getElementById('schema-form').dataset.projectId = project.id;
                    
                    // Update YAML read selector
                    updateYamlReadSelector(projectId);
                }
                
                // Update run project selector
                updateRunProjectSelector();
            } else {
                localStorage.removeItem(CURRENT_PROJECT_KEY);
            }
        });
        
        // Project modal handlers
        document.getElementById('new-project-btn').addEventListener('click', function() {
            // Clear the modal form
            document.getElementById('modal-project-name').value = '';
            document.getElementById('modal-keyspace-name').value = '';
            document.getElementById('modal-cql-schema').value = '';
            document.getElementById('modal-project-id').value = '';
            
            // Update modal title
            document.getElementById('project-modal-title').textContent = 'Create New Project';
            
            // Show the modal
            document.getElementById('project-modal').classList.remove('hidden');
        });
        
        document.getElementById('create-project-btn').addEventListener('click', function() {
            // Trigger the new project button
            document.getElementById('new-project-btn').click();
        });
        
        document.getElementById('project-modal-close').addEventListener('click', function() {
            // Hide the modal
            document.getElementById('project-modal').classList.add('hidden');
        });
        
        document.getElementById('project-modal-cancel').addEventListener('click', function() {
            // Hide the modal
            document.getElementById('project-modal').classList.add('hidden');
        });
        
        document.getElementById('project-modal-save').addEventListener('click', function() {
            // Get values from the form
            const name = document.getElementById('modal-project-name').value;
            const keyspace = document.getElementById('modal-keyspace-name').value;
            const schema = document.getElementById('modal-cql-schema').value;
            const projectId = document.getElementById('modal-project-id').value || generateId();
            
            if (!name || !keyspace || !schema) {
                alert('Please fill in all required fields.');
                return;
            }
            
            // Create project object
            const project = {
                id: projectId,
                name: name,
                keyspace: keyspace,
                schema: schema,
                created: new Date().toISOString(),
                yamlFiles: []
            };
            
            // If editing an existing project, preserve its YAML files
            if (document.getElementById('modal-project-id').value) {
                const existingProject = getProjectById(projectId);
                if (existingProject && existingProject.yamlFiles) {
                    project.yamlFiles = existingProject.yamlFiles;
                }
            }
            
            // Save the project
            if (saveProject(project)) {
                // Hide the modal
                document.getElementById('project-modal').classList.add('hidden');
                
                // Show success message
                showAlert('projects-list-alerts', 'success', `Project "${name}" saved successfully.`, true);
                
                // Navigate to projects list
                document.getElementById('projects-list').click();
            } else {
                alert('Failed to save project. Please try again.');
            }
        });
        
        // Save schema button handler
        document.getElementById('save-schema-btn').addEventListener('click', function() {
            // Get values from the form
            const name = document.getElementById('project-name').value;
            const keyspace = document.getElementById('keyspace-name').value;
            const schema = document.getElementById('cql-schema').value;
            const projectId = document.getElementById('schema-form').dataset.projectId || generateId();
            
            if (!name || !keyspace || !schema) {
                showAlert('schema-alerts', 'danger', 'Please fill in all required fields.');
                return;
            }
            
            // Create project object
            const project = {
                id: projectId,
                name: name,
                keyspace: keyspace,
                schema: schema,
                created: new Date().toISOString()
            };
            
            // If editing an existing project, preserve its YAML files
            if (document.getElementById('schema-form').dataset.projectId) {
                const existingProject = getProjectById(projectId);
                if (existingProject && existingProject.yamlFiles) {
                    project.yamlFiles = existingProject.yamlFiles;
                } else {
                    project.yamlFiles = [];
                }
            } else {
                project.yamlFiles = [];
            }
            
            // Save the project
            if (saveProject(project)) {
                // Show success message
                showAlert('schema-alerts', 'success', `Project "${name}" saved successfully.`, true);
                
                // Update schema form with the project ID
                document.getElementById('schema-form').dataset.projectId = project.id;
            } else {
                showAlert('schema-alerts', 'danger', 'Failed to save project. Please try again.');
            }
        });
        
        // Environment variable modal handlers
        document.getElementById('add-env-var-btn').addEventListener('click', function() {
            // Clear the modal form
            document.getElementById('modal-env-var-name').value = '';
            document.getElementById('modal-env-var-value').value = '';
            document.getElementById('modal-env-var-description').value = '';
            document.getElementById('modal-env-var-is-secret').value = 'no';
            document.getElementById('modal-env-var-id').value = '';
            
            // Update modal title
            document.getElementById('env-var-modal-title').textContent = 'Add Environment Variable';
            
            // Show the modal
            document.getElementById('env-var-modal').classList.remove('hidden');
        });
        
        document.getElementById('env-var-modal-close').addEventListener('click', function() {
            // Hide the modal
            document.getElementById('env-var-modal').classList.add('hidden');
        });
        
        document.getElementById('env-var-modal-cancel').addEventListener('click', function() {
            // Hide the modal
            document.getElementById('env-var-modal').classList.add('hidden');
        });
        
        document.getElementById('env-var-modal-save').addEventListener('click', function() {
            // Get values from the form
            const name = document.getElementById('modal-env-var-name').value;
            const value = document.getElementById('modal-env-var-value').value;
            const description = document.getElementById('modal-env-var-description').value;
            const isSecret = document.getElementById('modal-env-var-is-secret').value === 'yes';
            const envVarId = document.getElementById('modal-env-var-id').value || generateId();
            
            if (!name || !value) {
                alert('Please fill in all required fields.');
                return;
            }
            
            // Create environment variable object
            const envVar = {
                id: envVarId,
                name: name,
                value: value,
                description: description,
                isSecret: isSecret,
                created: new Date().toISOString()
            };
            
            // Save the environment variable
            if (saveEnvironmentVariable(envVar)) {
                // Hide the modal
                document.getElementById('env-var-modal').classList.add('hidden');
                
                // Show success message
                showAlert('env-config-alerts', 'success', `Environment variable "${name}" saved successfully.`, true);
            } else {
                alert('Failed to save environment variable. Please try again.');
            }
        });
        
        // Save all environment variables button
        document.getElementById('save-env-vars-btn').addEventListener('click', function() {
            showAlert('env-config-alerts', 'success', 'All environment variables saved successfully.', true);
        });
        
        // Database form type change handlers
        document.getElementById('origin-type').addEventListener('change', function() {
            const dbType = this.value;
            
            if (dbType === 'astra') {
                document.getElementById('astra-origin-fields').classList.remove('hidden');
                document.getElementById('cassandra-origin-fields').classList.add('hidden');
            } else {
                document.getElementById('astra-origin-fields').classList.add('hidden');
                document.getElementById('cassandra-origin-fields').classList.remove('hidden');
            }
        });
        
        document.getElementById('dest-type').addEventListener('change', function() {
            const dbType = this.value;
            
            if (dbType === 'astra') {
                document.getElementById('astra-dest-fields').classList.remove('hidden');
                document.getElementById('cassandra-dest-fields').classList.add('hidden');
            } else {
                document.getElementById('astra-dest-fields').classList.add('hidden');
                document.getElementById('cassandra-dest-fields').classList.remove('hidden');
            }
        });
        
        // Database form env vars change handlers
        document.getElementById('origin-use-env-vars').addEventListener('change', function() {
            const useEnvVars = this.value === 'yes';
            
            if (useEnvVars) {
                document.getElementById('origin-env-vars').classList.remove('hidden');
            } else {
                document.getElementById('origin-env-vars').classList.add('hidden');
            }
        });
        
        document.getElementById('dest-use-env-vars').addEventListener('change', function() {
            const useEnvVars = this.value === 'yes';
            
            if (useEnvVars) {
                document.getElementById('dest-env-vars').classList.remove('hidden');
            } else {
                document.getElementById('dest-env-vars').classList.add('hidden');
            }
        });
        
        // Clear form button handlers
        document.getElementById('clear-origin-form-btn').addEventListener('click', function() {
            document.getElementById('origin-db-form').reset();
            delete document.getElementById('origin-db-form').dataset.connectionId;
            
            // Trigger change events
            document.getElementById('origin-type').dispatchEvent(new Event('change'));
            document.getElementById('origin-use-env-vars').dispatchEvent(new Event('change'));
            
            showAlert('origin-db-alerts', 'info', 'Form cleared.', true);
        });
        
        document.getElementById('clear-dest-form-btn').addEventListener('click', function() {
            document.getElementById('destination-db-form').reset();
            delete document.getElementById('destination-db-form').dataset.connectionId;
            
            // Trigger change events
            document.getElementById('dest-type').dispatchEvent(new Event('change'));
            document.getElementById('dest-use-env-vars').dispatchEvent(new Event('change'));
            
            showAlert('destination-db-alerts', 'info', 'Form cleared.', true);
        });
        
        // Origin database form submission
        document.getElementById('origin-db-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get the connection ID if editing
            const connectionId = this.dataset.connectionId || generateId();
            
            // Get values from the form
            const name = document.getElementById('origin-name').value;
            const dbType = document.getElementById('origin-type').value;
            const useEnvV                        <div class="form-group">
                            <label for="dest-use-env-vars">Use Environment Variables</label>
                            <select id="dest-use-env-vars" name="dest-use-env-vars">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                            </select>
                            <small>If selected, environment variables will be used to replace credentials</small>
                        </div>
                        
                        <div id="dest-env-vars" class="hidden">
                            <div class="form-group">
                                <label for="dest-username-var">Username Variable</label>
                                <select id="dest-username-var" name="dest-username-var">
                                    <option value="">Select a variable</option>
                                    <!-- Populated dynamically -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="dest-password-var">Password Variable</label>
                                <select id="dest-password-var" name="dest-password-var">
                                    <option value="">Select a variable</option>
                                    <!-- Populated dynamically -->
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary" id="test-dest-conn-btn">Test Connection</button>
                            <button type="button" class="btn btn-secondary" id="save-dest-conn-btn">Save Connection</button>
                            <button type="button" class="btn" id="clear-dest-form-btn">Clear Form</button>
                        </div>
                    </form>
                    
                    <div class="loading" id="dest-db-loading">
                        <div class="spinner"></div>
                        <p>Testing connection...</p>
                    </div>
                    
                    <div id="dest-connections-container" style="margin-top: 30px;">
                        <h3>Saved Destination Connections</h3>
                        <table id="dest-connections-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Type</th>
                                    <th>Host(s)</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Connections will be populated dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- YAML Read Tool Card -->
                <div class="card hidden" id="yaml-read-card">
                    <h2>YAML Read Tool</h2>
                    <div id="yaml-read-alerts"></div>
                    <div class="form-group">
                        <label for="yaml-read-file">Select YAML File</label>
                        <select id="yaml-read-file" name="yaml-read-file">
                            <option value="">Select YAML file</option>
                            <!-- Will be populated dynamically -->
                        </select>
                    </div>
                    <div class="form-group">
                        <button class="btn btn-primary" id="yaml-read-btn">Read YAML</button>
                    </div>
                    <pre class="output-yaml hidden" id="yaml-read-output"></pre>
                </div>
                
                <!-- DSBulk Tool Card -->
                <div class="card hidden" id="dsbulk-card">
                    <h2>DSBulk Tool</h2>
                    <div id="dsbulk-alerts"></div>
                    <form id="dsbulk-form">
                        <div class="form-group">
                            <label for="dsbulk-mode">Operation Mode</label>
                            <select id="dsbulk-mode" name="dsbulk-mode">
                                <option value="load">Load (Import)</option>
                                <option value="unload">Unload (Export)</option>
                                <option value="count">Count</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="dsbulk-connection">Database Connection</label>
                            <select id="dsbulk-connection" name="dsbulk-connection">
                                <option value="">Select a connection</option>
                                <!-- Will be populated dynamically -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="dsbulk-keyspace">Keyspace</label>
                            <input type="text" id="dsbulk-keyspace" name="dsbulk-keyspace">
                        </div>
                        <div class="form-group">
                            <label for="dsbulk-table">Table</label>
                            <input type="text" id="dsbulk-table" name="dsbulk-table">
                        </div>
                        <div class="form-group">
                            <label for="dsbulk-csv">CSV File Path</label>
                            <input type="text" id="dsbulk-csv" name="dsbulk-csv" placeholder="/path/to/data.csv">
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary" id="dsbulk-run-btn">Run DSBulk</button>
                        </div>
                    </form>
                    
                    <div class="loading" id="dsbulk-loading">
                        <div class="spinner"></div>
                        <p>Running DSBulk operation...</p>
                    </div>
                    
                    <pre class="output-yaml hidden" id="dsbulk-output"></pre>
                </div>
                
                <!-- Run Benchmark Card -->
                <div class="card hidden" id="run-bench-card">
                    <h2>Run NoSQLBench Workload</h2>
                    <div id="run-alerts"></div>
                    <form id="run-form">
                        <div class="form-group">
                            <label for="run-project">Project</label>
                            <select id="run-project" name="run-project">
                                <option value="">Select a project</option>
                                <!-- Projects will be populated dynamically -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="run-yaml-file">Select YAML File</label>
                            <select id="run-yaml-file" name="run-yaml-file">
                                <option value="">Select YAML file</option>
                                <!-- YAML files will be populated dynamically -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="run-connection">Database Connection</label>
                            <select id="run-connection" name="run-connection">
                                <option value="">Select a connection</option>
                                <!-- Connections will be populated dynamically -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="run-command-options">Additional Command Options</label>
                            <input type="text" id="run-command-options" name="run-command-options" placeholder="E.g., write_cl=LOCAL_ONE threads=16" style="font-family: monospace;">
                        </div>
                        <div style="background-color: #f8f9fa; padding: 15px; border-radius: 4px; margin-bottom: 20px;">
                            <h4>Command Preview</h4>
                            <pre id="run-command-preview" style="margin: 0; font-family: monospace;">java -jar nb5.jar [yaml-file] host=[host] localdc=[datacenter] keyspace=[keyspace] --progress console:1s</pre>
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary" id="run-bench-btn" style="font-size: 16px; padding: 10px 20px;">
                                <span style="margin-right: 8px;">▶</span> Run NoSQLBench
                            </button>
                            <button type="button" class="btn" id="run-direct-btn" style="font-size: 16px; padding: 10px 20px; margin-left: 10px;">
                                <span style="margin-right: 8px;">⚡</span> Run Direct
                            </button>
                        </div>
                    </form>
                    
                    <div class="loading" id="run-loading">
                        <div class="spinner"></div>
                        <p>Running NoSQLBench...</p>
                    </div>
                    
                    <div id="run-output" class="hidden">
                        <h3>Execution Output</h3>
                        <pre class="output-yaml" id="execution-output"></pre>
                        <div id="process-controls" class="hidden" style="margin-top: 15px;">
                            <button class="btn" id="refresh-output-btn">Refresh Output</button>
                            <span id="process-status" style="margin-left: 10px;"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal for creating/editing projects -->
    <div id="project-modal" class="modal-backdrop hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="project-modal-title">Create New Project</h3>
                <button class="modal-close" id="project-modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="project-modal-form">
                    <div class="form-group">
                        <label for="modal-project-name">Project Name</label>
                        <input type="text" id="modal-project-name" name="modal-project-name" required>
                    </div>
                    <div class="form-group">
                        <label for="modal-keyspace-name">Keyspace Name</label>
                        <input type="text" id="modal-keyspace-name" name="modal-keyspace-name" required>
                    </div>
                    <div class="form-group">
                        <label for="modal-cql-schema">CQL Schema</label>
                        <textarea id="modal-cql-schema" name="modal-cql-schema" rows="10" required></textarea>
                    </div>
                    <input type="hidden" id="modal-project-id" name="modal-project-id">
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn" id="project-modal-cancel">Cancel</button>
                <button class="btn btn-primary" id="project-modal-save">Save Project</button>
            </div>
        </div>
    </div>
    
    <!-- Modal for creating/editing environment variables -->
    <div id="env-var-modal" class="modal-backdrop hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="env-var-modal-title">Add Environment Variable</h3>
                <button class="modal-close" id="env-var-modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="env-var-modal-form">
                    <div class="form-group">
                        <label for="modal-env-var-name">Variable Name</label>
                        <input type="text" id="modal-env-var-name" name="modal-env-var-name" required>
                    </div>
                    <div class="form-group">
                        <label for="modal-env-var-value">Variable Value</label>
                        <input type="text" id="modal-env-var-value" name="modal-env-var-value" required>
                    </div>
                    <div class="form-group">
                        <label for="modal-env-var-description">Description (Optional)</label>
                        <input type="text" id="modal-env-var-description" name="modal-env-var-description">
                    </div>
                    <div class="form-group">
                        <label for="modal-env-var-is-secret">Is Secret?</label>
                        <select id="modal-env-var-is-secret" name="modal-env-var-is-secret">
                            <option value="no">No</option>
                            <option value="yes">Yes</option>
                        </select>
                        <small>Secret values will be masked in the UI</small>
                    </div>
                    <input type="hidden" id="modal-env-var-id" name="modal-env-var-id">
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn" id="env-var-modal-cancel">Cancel</button>
                <button class="btn btn-primary" id="env-var-modal-save">Save Variable</button>
            </div>
        </div>
    </div>
    
    <script>
        // Base URL for API calls - update if needed
        const API_BASE_URL = '';
        
        // Local storage keys
        const PROJECTS_STORAGE_KEY = 'nosqlbench_projects';
        const ENV_VARS_STORAGE_KEY = 'nosqlbench_env_vars';
        const ORIGIN_CONNS_STORAGE_KEY = 'nosqlbench_origin_conns';
        const DEST_CONNS_STORAGE_KEY = 'nosqlbench_dest_conns';
        const CURRENT_PROJECT_KEY = 'nosqlbench_current_project';
        
        // Utility function to show alerts
        function showAlert(containerId, type, message, autoHide = false) {
            const container = document.getElementById(containerId);
            if (!container) return null;
            
            // Create alert
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            
            // Add message
            alert.textContent = message;
            
            // Add to container
            container.innerHTML = '';
            container.appendChild(alert);
            
            // Auto-hide if requested
            if (autoHide) {
                setTimeout(() => {
                    if (alert.parentNode === container) {
                        container.removeChild(alert);
                    }
                }, 5000);
            }
            
            return alert;
        }
        
        // Function to show/hide loading spinner
        function toggleLoading(elementId, show) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            element.style.display = show ? 'block' : 'none';
        }
        
        // Function to generate a unique ID
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substring(2, 10);
        }
        
        // Function to safely get data from localStorage with error handling
        function getLocalStorageItem(key, defaultValue = '[]') {
            try {
                const data = localStorage.getItem(key);
                if (data === null) return JSON.parse(defaultValue);
                return JSON.parse(data);
            } catch (error) {
                console.error(`Error parsing data from localStorage for key ${key}:`, error);
                return JSON.parse(defaultValue);
            }
        }
        
        // Function to safely set data to localStorage with error handling
        function setLocalStorageItem(key, value) {
            try {
                localStorage.setItem(key, JSON.stringify(value));
                return true;
            } catch (error) {
                console.error(`Error setting data to localStorage for key ${key}:`, error);
                return false;
            }
        }
        
        // Function to save a project
        function saveProject(project) {
            const projects = getLocalStorageItem(PROJECTS_STORAGE_KEY);
            
            // Check if project already exists
            const existingIndex = projects.findIndex(p => p.id === project.id);
            if (existingIndex >= 0) {
                // Update existing project
                projects[existingIndex] = project;
            } else {
                // Add new project
                projects.push(project);
            }
            
            // Save to local storage
            setLocalStorageItem(PROJECTS_STORAGE_KEY, projects);
            
            // Update current project if needed
            const currentProjectId = localStorage.getItem(CURRENT_PROJECT_KEY);
            if (!currentProjectId || currentProjectId === project.id) {
                localStorage.setItem(CURRENT_PROJECT_KEY, project.id);
                updateCurrentProjectSelector();
            }
            
            // Refresh project list
            loadProjects();
            
            return true;
        }
        
        // Function to delete a project
        function deleteProject(projectId) {
            const projects = getLocalStorageItem(PROJECTS_STORAGE_KEY);
            
            // Filter out the deleted project
            const updatedProjects = projects.filter(p => p.id !== projectId);
            
            // Save the updated projects
            setLocalStorageItem(PROJECTS_STORAGE_KEY, updatedProjects);
            
            // Clear current project if it was deleted
            const currentProjectId = localStorage.getItem(CURRENT_PROJECT_KEY);
            if (currentProjectId === projectId) {
                localStorage.removeItem(CURRENT_PROJECT_KEY);
                updateCurrentProjectSelector();
            }
            
            // Refresh project list
            loadProjects();
            
            return true;
        }
        
        // Function to load projects and update UI
        function loadProjects() {
            const projects = getLocalStorageItem(PROJECTS_STORAGE_KEY);
            const projectsContainer = document.getElementById('projects-container');
            const noProjectsElement = document.getElementById('no-projects');
            
            if (!projectsContainer || !noProjectsElement) return;
            
            // Clear the container
            projectsContainer.innerHTML = '';
            
            // Show or hide 'no projects' message
            if (projects.length === 0) {
                noProjectsElement.classList.remove('hidden');
            } else {
                noProjectsElement.classList.add('hidden');
                
                // Add each project to the list
                projects.forEach(project => {
                    const projectItem = document.createElement('li');
                    projectItem.className = 'project-item';
                    
                    const projectInfo = document.createElement('div');
                    projectInfo.className = 'project-info';
                    
                    const projectName = document.createElement('div');
                    projectName.className = 'project-name';
                    projectName.textContent = project.name;
                    
                    const projectDetails = document.createElement('div');
                    projectDetails.className = 'project-details';
                    projectDetails.textContent = `Keyspace: ${project.keyspace} | Created: ${new Date(project.created).toLocaleDateString()}`;
                    
                    projectInfo.appendChild(projectName);
                    projectInfo.appendChild(projectDetails);
                    
                    const projectActions = document.createElement('div');
                    projectActions.className = 'project-actions';
                    
                    const selectButton = document.createElement('button');
                    selectButton.className = 'action-btn select';
                    selectButton.innerHTML = '✓';
                    selectButton.title = 'Select Project';
                    selectButton.addEventListener('click', () => selectProject(project.id));
                    
                    const editButton = document.createElement('button');
                    editButton.className = 'action-btn edit';
                    editButton.innerHTML = '✏️';
                    editButton.title = 'Edit Project';
                    editButton.addEventListener('click', () => editProject(project.id));
                    
                    const deleteButton = document.createElement('button');
                    deleteButton.className = 'action-btn delete';
                    deleteButton.innerHTML = '🗑️';
                    deleteButton.title = 'Delete Project';
                    deleteButton.addEventListener('click', () => confirmDeleteProject(project.id, project.name));
                    
                    projectActions.appendChild(selectButton);
                    projectActions.appendChild(editButton);
                    projectActions.appendChild(deleteButton);
                    
                    projectItem.appendChild(projectInfo);
                    projectItem.appendChild(projectActions);
                    
                    projectsContainer.appendChild(projectItem);
                });
            }
            
            // Update project selector in the header
            updateCurrentProjectSelector();
            
            // Update project selector in the run benchmark card
            updateRunProjectSelector();
        }
        
        // Function to load a project by ID
        function getProjectById(projectId) {
            if (!projectId) return null;
            
            const projects = getLocalStorageItem(PROJECTS_STORAGE_KEY);
            return projects.find(p => p.id === projectId) || null;
        }
        
        // Function to select a project
        function selectProject(projectId) {
            if (!projectId) return;
            
            localStorage.setItem(CURRENT_PROJECT_KEY, projectId);
            updateCurrentProjectSelector();
            
            // Load project data into forms
            const project = getProjectById(projectId);
            if (project) {
                document.getElementById('project-name').value = project.name || '';
                document.getElementById('keyspace-name').value = project.keyspace || '';
                document.getElementById('cql-schema').value = project.schema || '';
                
                // Update YAML read selector
                updateYamlReadSelector(projectId);
                
                // Update run YAML selector
                updateRunYamlFileSelector(projectId);
            }
            
            showAlert('projects-list-alerts', 'success', 'Project selected successfully.', true);
        }
        
        // Function to edit a project
        function editProject(projectId) {
            const project = getProjectById(projectId);
            if (!project) {
                showAlert('projects-list-alerts', 'danger', 'Project not found.');
                return;
            }
            
            // Fill the modal form
            document.getElementById('modal-project-name').value = project.name || '';
            document.getElementById('modal-keyspace-name').value = project.keyspace || '';
            document.getElementById('modal-cql-schema').value = project.schema || '';
            document.getElementById('modal-project-id').value = project.id;
            
            // Update modal title
            document.getElementById('project-modal-title').textContent = 'Edit Project';
            
            // Show the modal
            document.getElementById('project-modal').classList.remove('hidden');
        }
        
        // Function to confirm project deletion
        function confirmDeleteProject(projectId, projectName) {
            if (confirm(`Are you sure you want to delete the project "${projectName}"?`)) {
                deleteProject(projectId);
                showAlert('projects-list-alerts', 'success', `Project "${projectName}" deleted successfully.`, true);
            }
        }
        
        // Function to update the current project selector
        function updateCurrentProjectSelector() {
            const currentProjectId = localStorage.getItem(CURRENT_PROJECT_KEY);
            const projects = getLocalStorageItem(PROJECTS_STORAGE_KEY);
            const selector = document.getElementById('current-project-selector');
            
            if (!selector) return;
            
            // Clear the selector
            selector.innerHTML = '<option value="">Select Project</option>';
            
            // Add each project to the selector
            projects.forEach(project => {
                const option = document.createElement('option');
                option.value = project.id;
                option.textContent = project.name;
                selector.appendChild(option);
            });
            
            // Set the current project
            if (currentProjectId) {
                selector.value = currentProjectId;
            }
        }
        
        // Function to update the run project selector
        function updateRunProjectSelector() {
            const currentProjectId = localStorage.getItem(CURRENT_PROJECT_KEY);
            const projects = getLocalStorageItem(PROJECTS_STORAGE_KEY);
            const selector = document.getElementById('run-project');
            
            if (!selector) return;
            
            // Clear the selector
            selector.innerHTML = '<option value="">Select Project</option>';
            
            // Add each project to the selector
            projects.forEach(project => {
                const option = document.createElement('option');
                option.value = project.id;
                option.textContent = project.name;
                selector.appendChild(option);
            });
            
            // Set the current project
            if (currentProjectId) {
                selector.value = currentProjectId;
                // Update YAML files for this project
                updateRunYamlFileSelector(currentProjectId);
            }
        }
        
        // Function to update the run YAML file selector
        function updateRunYamlFileSelector(projectId) {
            const project = getProjectById(projectId);
            const selector = document.getElementById('run-yaml-file');
            
            if (!selector) return;
            
            // Clear the selector
            selector.innerHTML = '<option value="">Select YAML file</option>';
            
            if (project && project.yamlFiles && project.yamlFiles.length > 0) {
                // Add each YAML file to the selector
                project.yamlFiles.forEach(file => {
                    const option = document.createElement('option');
                    option.value = file.id;
                    option.textContent = file.name;
                    selector.appendChild(option);
                });
            }
            
            // Update command preview
            updateRunCommandPreview();
        }
        
        // Function to update the run command preview
        function updateRunCommandPreview() {
            const projectId = document.getElementById('run-project')?.value;
            const yamlFileId = document.getElementById('run-yaml-file')?.value;
            const connectionId = document.getElementById('run-connection')?.value;
            const commandOptions = document.getElementById('run-command-options')?.value || '';
            
            const project = getProjectById(projectId);
            
            // Get connection - handle both origin and destination
            let connection = null;
            let isOrigin = true;
            
            if (connectionId) {
                const connectionOption = document.querySelector(`#run-connection option[value="${connectionId}"]`);
                if (connectionOption) {
                    isOrigin = connectionOption.dataset.isOrigin !== 'false';
                }
                connection = getDatabaseConnectionById(connectionId, isOrigin);
            }
            
            let yamlFileName = '[yaml-file]';
            let host = '[host]';
            let datacenter = '[datacenter]';
            let keyspace = '[keyspace]';
            
            if (project) {
                keyspace = project.keyspace || '[keyspace]';
                
                if (project.yamlFiles && yamlFileId) {
                    const yamlFile = project.yamlFiles.find(f => f.id === yamlFileId);
                    if (yamlFile) {
                        yamlFileName = `./yaml_files/${yamlFile.name}`;
                    }
                }
            }
            
            if (connection) {
                if (connection.type === 'astra') {
                    host = connection.astraId || '[astra-id]';
                } else {
                    host = connection.hosts || '127.0.0.1';
                }
                datacenter = connection.datacenter || 'datacenter1';
            }
            
            // Build command preview
            const cmdPreview = `java -jar nb5.jar ${yamlFileName} \\
    host=${host} \\
    localdc=${datacenter} \\
    keyspace=${keyspace} \\
    --progress console:1s ${commandOptions}`;
            
            const previewElement = document.getElementById('run-command-preview');
            if (previewElement) {
                previewElement.textContent = cmdPreview;
            }
        }
        
        // Function to save an environment variable
        function saveEnvironmentVariable(envVar) {
            const envVars = getLocalStorageItem(ENV_VARS_STORAGE_KEY);
            
            // Check if variable already exists
            const existingIndex = envVars.findIndex(v => v.id === envVar.id);
            if (existingIndex >= 0) {
                // Update existing variable
                envVars[existingIndex] = envVar;
            } else {
                // Add new variable
                envVars.push(envVar);
            }
            
            // Save to local storage
            setLocalStorageItem(ENV_VARS_STORAGE_KEY, envVars);
            
            // Refresh environment variables list
            loadEnvironmentVariables();
            
            // Update env var selectors in database forms
            updateEnvVarSelectors();
            
            return true;
        }
        
        // Function to delete an environment variable
        function deleteEnvironmentVariable(envVarId) {
            const envVars = getLocalStorageItem(ENV_VARS_STORAGE_KEY);
            
            // Filter out the deleted variable
            const updatedEnvVars = envVars.filter(v => v.id !== envVarId);
            
            // Save the updated variables
            setLocalStorageItem(ENV_VARS_STORAGE_KEY, updatedEnvVars);
            
            // Refresh environment variables list
            loadEnvironmentVariables();
            
            // Update env var selectors in database forms
            updateEnvVarSelectors();
            
            return true;
        }
        
        // Function to load environment variables and update UI
        function loadEnvironmentVariables() {
            const envVars = getLocalStorageItem(ENV_VARS_STORAGE_KEY);
            const envVarsContainer = document.getElementById('env-variables-container');
            
            if (!envVarsContainer) return;
            
            // Clear the container
            envVarsContainer.innerHTML = '';
            
            if (envVars.length === 0) {
                const noVarsMessage = document.createElement('p');
                noVarsMessage.textContent = 'No environment variables defined yet. Click "Add New Variable" to create one.';
                noVarsMessage.style.fontStyle = 'italic';
                noVarsMessage.style.color = '#666';
                noVarsMessage.style.padding = '10px';
                envVarsContainer.appendChild(noVarsMessage);
                return;
            }
            
            // Add each environment variable to the list
            envVars.forEach(envVar => {
                const varElement = document.createElement('div');
                varElement.className = 'env-variable';
                
                const nameInput = document.createElement('input');
                nameInput.type = 'text';
                nameInput.className = 'env-variable-name';
                nameInput.value = envVar.name || '';
                nameInput.readOnly = true;
                
                const valueInput = document.createElement('input');
                valueInput.type = envVar.isSecret ? 'password' : 'text';
                valueInput.className = 'env-variable-value';
                valueInput.value = envVar.value || '';
                valueInput.readOnly = true;
                
                const actionsDiv = document.createElement('div');
                actionsDiv.className = 'env-variable-actions';
                
                const editButton = document.createElement('button');
                editButton.className = 'action-btn edit';
                editButton.innerHTML = '✏️';
                editButton.title = 'Edit Variable';
                editButton.addEventListener('click', () => editEnvironmentVariable(envVar.id));
                
                const deleteButton = document.createElement('button');
                deleteButton.className = 'action-btn delete';
                deleteButton.innerHTML = '🗑️';
                deleteButton.title = 'Delete Variable';
                deleteButton.addEventListener('click', () => confirmDeleteEnvironmentVariable(envVar.id, envVar.name));
                
                actionsDiv.appendChild(editButton);
                actionsDiv.appendChild(deleteButton);
                
                varElement.appendChild(nameInput);
                varElement.<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NoSQL Bench</title>
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2ecc71;
            --dark: #2c3e50;
            --light: #ecf0f1;
            --danger: #e74c3c;
            --warning: #f39c12;
            --info: #1abc9c;
            --sidebar-width: 250px;
            --header-height: 60px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        
        header {
            background-color: var(--dark);
            color: var(--light);
            padding: 0 20px;
            height: var(--header-height);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 100;
        }

        .header-title {
            font-size: 24px;
            font-weight: bold;
        }
        
        .project-selector {
            display: flex;
            align-items: center;
            color: white;
        }
        
        .project-selector select {
            margin-left: 10px;
            padding: 5px;
            border-radius: 4px;
            border: none;
            min-width: 200px;
        }
        
        .main-container {
            display: flex;
            margin-top: var(--header-height);
            height: calc(100vh - var(--header-height));
        }
        
        .sidebar {
            width: var(--sidebar-width);
            background-color: #fff;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            padding: 20px;
            overflow-y: auto;
            flex-shrink: 0;
        }
        
        .content-area {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        
        .sidebar-section {
            margin-bottom: 25px;
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
        }
        
        .sidebar-section:last-child {
            border-bottom: none;
        }
        
        .sidebar-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: var(--dark);
        }
        
        .sidebar-item {
            margin-bottom: 10px;
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        
        .sidebar-item:hover {
            background-color: #f0f0f0;
        }
        
        .sidebar-item.active {
            background-color: var(--primary);
            color: white;
        }
        
        .workflow-container {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            padding: 20px 0;
        }
        
        .workflow-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
            position: relative;
            padding: 0 40px;
        }
        
        .workflow-line {
            position: absolute;
            top: 50%;
            left: 30px;
            right: 30px;
            height: 2px;
            background-color: #ccc;
            z-index: 1;
        }
        
        .step {
            background-color: white;
            border-radius: 8px;
            padding: 15px;
            min-width: 120px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            z-index: 2;
            position: relative;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .step:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .step.active {
            background-color: var(--primary);
            color: white;
        }
        
        .step-arrow {
            position: absolute;
            top: 50%;
            right: -30px;
            transform: translateY(-50%);
            width: 30px;
            height: 30px;
            color: #666;
            z-index: 2;
        }
        
        .card {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 20px;
            flex-grow: 1;
            overflow-y: auto;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        textarea {
            min-height: 150px;
            font-family: monospace;
        }
        
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: var(--primary);
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-size: 14px;
        }
        
        .btn:hover {
            background-color: #2980b9;
        }
        
        .btn-secondary {
            background-color: var(--secondary);
        }
        
        .btn-secondary:hover {
            background-color: #27ae60;
        }
        
        .btn-danger {
            background-color: var(--danger);
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .alert {
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        
        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-danger {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .alert-info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .output-yaml {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .hidden {
            display: none;
        }
        
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border-left-color: var(--primary);
            animation: spin 1s linear infinite;
            display: inline-block;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading {
            text-align: center;
            margin: 20px 0;
            display: none;
        }
        
        /* Environment variable styles */
        .env-variable {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
        }
        
        .env-variable input {
            margin-right: 10px;
        }
        
        .env-variable-name {
            flex: 1;
        }
        
        .env-variable-value {
            flex: 2;
        }
        
        .env-variable-actions {
            width: 60px;
            text-align: right;
        }
        
        .env-variable-actions button {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--danger);
            font-size: 18px;
            margin-left: 5px;
        }
        
        /* Database card styles */
        .connection-status {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-left: 5px;
        }
        
        .connected {
            background-color: var(--secondary);
        }
        
        .disconnected {
            background-color: var(--danger);
        }
        
        /* Project list styles */
        .project-list {
            list-style: none;
        }
        
        .project-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin-bottom: 10px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border-left: 4px solid var(--primary);
        }
        
        .project-info {
            flex: 1;
        }
        
        .project-actions {
            width: 120px;
            text-align: right;
        }
        
        .project-name {
            font-weight: bold;
            font-size: 16px;
        }
        
        .project-details {
            font-size: 14px;
            color: #666;
        }
        
        /* Table styles */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        table th, table td {
            padding: 10px;
            border-bottom: 1px solid #ddd;
            text-align: left;
        }
        
        table th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        
        /* Modal styles */
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .modal-content {
            background-color: #fff;
            border-radius: 8px;
            padding: 20px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #ddd;
        }
        
        .modal-title {
            font-size: 20px;
            font-weight: bold;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            padding-top: 15px;
            margin-top: 15px;
            border-top: 1px solid #ddd;
        }
        
        .modal-footer .btn {
            margin-left: 10px;
        }
        
        /* Action button styles */
        .action-btn {
            background: none;
            border: none;
            cursor: pointer;
            margin-left: 5px;
            padding: 5px;
            border-radius: 4px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .action-btn:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }
        
        .action-btn.edit {
            color: var(--primary);
        }
        
        .action-btn.delete {
            color: var(--danger);
        }
        
        .action-btn.select {
            color: var(--secondary);
        }
    </style>
</head>
<body>
    <header>
        <div class="header-title">NoSQL BENCH</div>
        <div class="project-selector">
            <span>Current Project:</span>
            <select id="current-project-selector">
                <option value="">Select Project</option>
                <!-- Projects will be populated dynamically -->
            </select>
            <button class="btn btn-secondary" id="new-project-btn" style="margin-left: 10px;">New Project</button>
        </div>
    </header>
    
    <div class="main-container">
        <div class="sidebar">
            <div class="sidebar-section">
                <div class="sidebar-title">Project Management</div>
                <div class="sidebar-item" id="projects-list">Projects List</div>
                <div class="sidebar-item" id="project-config">Project & Schema</div>
                <div class="sidebar-item" id="yaml-config">YAML Files</div>
            </div>
            
            <div class="sidebar-section">
                <div class="sidebar-title">Infrastructure</div>
                <div class="sidebar-item" id="env-config">Environment Variables</div>
                <div class="sidebar-item" id="origin-db">Origin Database</div>
                <div class="sidebar-item" id="destination-db">Destination Database</div>
            </div>
            
            <div class="sidebar-section">
                <div class="sidebar-title">Tools</div>
                <div class="sidebar-item" id="yaml-read">YAML Read</div>
                <div class="sidebar-item" id="dsbulk">DSBULK</div>
                <div class="sidebar-item" id="run-bench">Run Benchmark</div>
            </div>
        </div>
        
        <div class="content-area">
            <div class="workflow-container">
                <!-- Project List Card -->
                <div class="card hidden" id="projects-list-card">
                    <h2>Projects List</h2>
                    <div id="projects-list-alerts"></div>
                    
                    <div class="form-group">
                        <button class="btn btn-primary" id="create-project-btn">Create New Project</button>
                    </div>
                    
                    <div id="no-projects" class="hidden">
                        <p>No projects found. Click 'Create New Project' to get started.</p>
                    </div>
                    
                    <ul class="project-list" id="projects-container">
                        <!-- Projects will be populated dynamically -->
                    </ul>
                </div>
                
                <!-- Project Configuration Card -->
                <div class="card hidden" id="schema-card">
                    <h2>Define CQL Schema</h2>
                    <div id="schema-alerts"></div>
                    <form id="schema-form">
                        <div class="form-group">
                            <label for="project-name">Project Name</label>
                            <input type="text" id="project-name" name="project-name" placeholder="Enter project name" required>
                        </div>
                        <div class="form-group">
                            <label for="keyspace-name">Keyspace Name</label>
                            <input type="text" id="keyspace-name" name="keyspace-name" placeholder="Enter keyspace name" required>
                        </div>
                        <div class="form-group">
                            <label for="cql-schema">CQL Schema</label>
                            <textarea id="cql-schema" name="cql-schema" placeholder="Paste your CQL schema here (CREATE TABLE statements)" required></textarea>
                            <div style="margin-top: 10px;">
                                <label for="schema-file" class="btn" style="margin-right: 10px; display: inline-block; width: auto;">
                                    <span style="margin-right: 5px;">📁</span> Upload Schema File
                                </label>
                                <input type="file" id="schema-file" accept=".cql,.sql,.txt" style="display: none;">
                                <span id="file-name" style="margin-left: 10px; font-style: italic;"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary" id="parse-schema-btn">Parse Schema</button>
                            <button type="button" class="btn" id="load-example-btn" style="margin-left: 10px;">Load Example</button>
                            <button type="button" class="btn btn-secondary" id="save-schema-btn" style="margin-left: 10px;">Save Project</button>
                        </div>
                    </form>
                    <div class="loading" id="schema-loading">
                        <div class="spinner"></div>
                        <p>Parsing schema...</p>
                    </div>
                </div>
                
                <!-- YAML Generation Card -->
                <div class="card hidden" id="yaml-card">
                    <h2>Configure YAML Generation</h2>
                    <div id="yaml-alerts"></div>
                    <form id="yaml-form">
                        <div class="form-group">
                            <label>Data Generation Settings</label>
                            <div class="form-group">
                                <label for="num-cycles">Number of Cycles (Data Records)</label>
                                <input type="number" id="num-cycles" name="num-cycles" value="10000000" required>
                            </div>
                            <div class="form-group">
                                <label for="threads">Number of Threads</label>
                                <select id="threads" name="threads">
                                    <option value="auto">Auto (Recommended)</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="4">4</option>
                                    <option value="8">8</option>
                                    <option value="16">16</option>
                                    <option value="32">32</option>
                                    <option value="64">64</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary" id="generate-yaml-btn">Generate YAML</button>
                    </form>
                    
                    <div class="loading" id="yaml-loading">
                        <div class="spinner"></div>
                        <p>Generating YAML files...</p>
                    </div>
                    
                    <div class="hidden" id="yaml-output">
                        <h3>Generated YAML</h3>
                        <div id="yaml-tabs" class="tabs" style="display: flex; margin-top: 20px;"></div>
                        <pre class="output-yaml" id="yaml-content"></pre>
                        <div style="margin-top: 15px;">
                            <button class="btn btn-secondary" id="download-all-btn">Download All</button>
                            <button class="btn" id="copy-yaml-btn">Copy Current</button>
                        </div>
                    </div>
                </div>
                
                <!-- Environment Variables Card -->
                <div class="card hidden" id="env-config-card">
                    <h2>Environment Variables Configuration</h2>
                    <div id="env-config-alerts"></div>
                    
                    <p>Configure environment variables that will be available for all your NoSQLBench operations.</p>
                    
                    <div class="form-group">
                        <button id="add-env-var-btn" class="btn btn-primary">Add New Variable</button>
                    </div>
                    
                    <div id="env-variables-container">
                        <!-- Environment variables will be added here dynamically -->
                    </div>
                    
                    <div class="form-group" style="margin-top: 20px;">
                        <button id="save-env-vars-btn" class="btn btn-secondary">Save All Variables</button>
                    </div>
                </div>
                
                <!-- Origin Database Card -->
                <div class="card hidden" id="origin-db-card">
                    <h2>Origin Database Configuration</h2>
                    <div id="origin-db-alerts"></div>
                    
                    <p>Configure the source database for your NoSQLBench operations.</p>
                    
                    <form id="origin-db-form">
                        <div class="form-group">
                            <label for="origin-name">Connection Name</label>
                            <input type="text" id="origin-name" name="origin-name" placeholder="Enter a name for this connection" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="origin-type">Database Type</label>
                            <select id="origin-type" name="origin-type">
                                <option value="cassandra">Apache Cassandra</option>
                                <option value="dse">DataStax Enterprise (DSE)</option>
                                <option value="astra">DataStax Astra DB</option>
                            </select>
                        </div>
                        
                        <div id="cassandra-origin-fields">
                            <div class="form-group">
                                <label for="origin-hosts">Host(s)</label>
                                <input type="text" id="origin-hosts" name="origin-hosts" placeholder="127.0.0.1" value="127.0.0.1">
                                <small>Comma-separated list for multiple hosts</small>
                            </div>
                            <div class="form-group">
                                <label for="origin-port">Port</label>
                                <input type="number" id="origin-port" name="origin-port" placeholder="9042" value="9042">
                            </div>
                            <div class="form-group">
                                <label for="origin-datacenter">Local Datacenter</label>
                                <input type="text" id="origin-datacenter" name="origin-datacenter" placeholder="datacenter1" value="datacenter1">
                            </div>
                        </div>
                        
                        <div id="astra-origin-fields" class="hidden">
                            <div class="form-group">
                                <label for="origin-astra-id">Astra DB ID</label>
                                <input type="text" id="origin-astra-id" name="origin-astra-id" placeholder="00000000-0000-0000-0000-000000000000">
                            </div>
                            <div class="form-group">
                                <label for="origin-astra-region">Astra Region</label>
                                <input type="text" id="origin-astra-region" name="origin-astra-region" placeholder="us-east1">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="origin-username">Username</label>
                            <input type="text" id="origin-username" name="origin-username" placeholder="cassandra">
                        </div>
                        <div class="form-group">
                            <label for="origin-password">Password</label>
                            <input type="password" id="origin-password" name="origin-password" placeholder="cassandra">
                        </div>
                        
                        <div class="form-group">
                            <label for="origin-use-env-vars">Use Environment Variables</label>
                            <select id="origin-use-env-vars" name="origin-use-env-vars">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                            </select>
                            <small>If selected, environment variables will be used to replace credentials</small>
                        </div>
                        
                        <div id="origin-env-vars" class="hidden">
                            <div class="form-group">
                                <label for="origin-username-var">Username Variable</label>
                                <select id="origin-username-var" name="origin-username-var">
                                    <option value="">Select a variable</option>
                                    <!-- Populated dynamically -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="origin-password-var">Password Variable</label>
                                <select id="origin-password-var" name="origin-password-var">
                                    <option value="">Select a variable</option>
                                    <!-- Populated dynamically -->
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary" id="test-origin-conn-btn">Test Connection</button>
                            <button type="button" class="btn btn-secondary" id="save-origin-conn-btn">Save Connection</button>
                            <button type="button" class="btn" id="clear-origin-form-btn">Clear Form</button>
                        </div>
                    </form>
                    
                    <div class="loading" id="origin-db-loading">
                        <div class="spinner"></div>
                        <p>Testing connection...</p>
                    </div>
                    
                    <div id="origin-connections-container" style="margin-top: 30px;">
                        <h3>Saved Origin Connections</h3>
                        <table id="origin-connections-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Type</th>
                                    <th>Host(s)</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Connections will be populated dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Destination Database Card -->
                <div class="card hidden" id="destination-db-card">
                    <h2>Destination Database Configuration</h2>
                    <div id="destination-db-alerts"></div>
                    
                    <p>Configure the target database for your NoSQLBench operations.</p>
                    
                    <form id="destination-db-form">
                        <div class="form-group">
                            <label for="dest-name">Connection Name</label>
                            <input type="text" id="dest-name" name="dest-name" placeholder="Enter a name for this connection" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="dest-type">Database Type</label>
                            <select id="dest-type" name="dest-type">
                                <option value="cassandra">Apache Cassandra</option>
                                <option value="dse">DataStax Enterprise (DSE)</option>
                                <option value="astra">DataStax Astra DB</option>
                            </select>
                        </div>
                        
                        <div id="cassandra-dest-fields">
                            <div class="form-group">
                                <label for="dest-hosts">Host(s)</label>
                                <input type="text" id="dest-hosts" name="dest-hosts" placeholder="127.0.0.1" value="127.0.0.1">
                                <small>Comma-separated list for multiple hosts</small>
                            </div>
                            <div class="form-group">
                                <label for="dest-port">Port</label>
                                <input type="number" id="dest-port" name="dest-port" placeholder="9042" value="9042">
                            </div>
                            <div class="form-group">
                                <label for="dest-datacenter">Local Datacenter</label>
                                <input type="text" id="dest-datacenter" name="dest-datacenter" placeholder="datacenter1" value="datacenter1">
                            </div>
                        </div>
                        
                        <div id="astra-dest-fields" class="hidden">
                            <div class="form-group">
                                <label for="dest-astra-id">Astra DB ID</label>
                                <input type="text" id="dest-astra-id" name="dest-astra-id" placeholder="00000000-0000-0000-0000-000000000000">
                            </div>
                            <div class="form-group">
                                <label for="dest-astra-region">Astra Region</label>
                                <input type="text" id="dest-astra-region" name="dest-astra-region" placeholder="us-east1">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="dest-username">Username</label>
                            <input type="text" id="dest-username" name="dest-username" placeholder="cassandra">
                        </div>
                        <div class="form-group">
                            <label for="dest-password">Password</label>
                            <input type="password" id="dest-password" name="dest-password" placeholder="cassandra">
                        </div>
                        
                        <div class="form-group">
                            <label for="dest-use-env-vars">Use Environment Variables</label>
                            <select id="dest-use-env-vars" name="dest-use-env-vars">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                            </select>
                            <small>If selected, environment variables will be used to replace credentials</small>
                        </div